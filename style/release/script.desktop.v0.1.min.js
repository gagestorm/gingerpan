function ajax(a,b,c,d){debug&&console.log("A "+a+" AJAX request to "+c+" with data:"),debug&&console.log(b),$.ajax({type:a,url:c,data:b,success:function(a){d(a)}})}var debug=!0,scriptsLoaded=[],templates={},API={},BASE=function(a){function b(){var a=!0;do{var b="gCStest="+Math.floor(1e8*Math.random());if(document.cookie=a?b+";expires=Tue, 01-Jan-2030 00:00:00 GMT":b,-1!==document.cookie.indexOf(b))return document.cookie=b+";expires=Sat, 01-Jan-2000 00:00:00 GMT",a}while(!(a=!a));return!1}function c(){return{expires:"",path:""}}var d=!1,e=!1;return Storage?(debug&&console.log("Supports Html5"),d=!0):(debug&&console.log("Doesnot support html5"),d=!1,e=b()),a.data=function(a,b,f){var g;if(d){if("undefined"!=typeof b)return sessionStorage.setItem(a,b),!0;g=sessionStorage.getItem(a)}else if(e){if("undefined"!=typeof b){f||(f=c());var h;if("undefined"!=typeof f.expires&&"number"==typeof f.expires){var i=new Date;i.setDate(i.getDate()+f.expires),h=i.toUTCString()}var j=a+"="+b;return j+=f.expires?";expires="+h:"",j+=f.path?";path="+f.path:"",document.cookie=j,!0}for(var k=document.cookie.split(";"),g=a?void 0:{},l=0,m=k.length;m>l;l++){var n=k[l].split("="),o=n[0].trim(),b=n[1].trim();if(a&&o===a){g=b;break}}}else alert("Your browser seems to be pretty old. Try new and visit us.");return g},a.remove=function(a,b){return d?null!==sessionStorage.getItem(a)?(sessionStorage.removeItem(a),!0):(debug&&console.log("No such key in local storage"),!1):void(e?(b||(b=c()),document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;;path="+b.path):alert("Your browser seems to be pretty old. Try new and visit us."))},a.serialToObject=function(a){for(var b,c=a.split("&"),d={},e=c.length,f=0;e>f;++f)b=c[f].split("="),2==b.length&&(d[b[0]]=b[1]);return d},a}(BASE||{}),API=function(a,b){debug&&console.log("Cart js just got loaded.");var c=function(a){var b='<div class="cart-item-container" id="item-'+a.sku+'">';return b+='<div class="item-image"><img src="'+base_url+"images/"+a.image+'" /></div><div class="item-info"><span class="item-name">'+a.name+'</span><div class="item-extra"><span class="item-serving">Serving</span><ul class="radio-list" data-sku="'+a.sku+'">',b+='<li><a href="#" class="opt opt-2 ',b+=2==a.serving?' selected" ':' " ',b+=">2</a></li>",b+='<li><a href="#" class="opt opt-4 ',b+=4==a.serving?' selected" ':' " ',b+=">4</a></li>",b+='<li><a href="#" class="opt opt-6 ',b+=6==a.serving?' selected" ':' " ',b+=">6</a></li>",b+="</ul></div></div></div>"};return a(document).on("click",".add-cart",function(c){c.preventDefault(),debug&&console.log("An item was added to the cart.");var d=a(this),e={};e.sku=d.attr("data-sku"),e.name=d.attr("data-name"),e.image=d.attr("data-image"),e.serving=2,debug&&console.log(e),b.updateCart(e)}),a(document).on("click",".opt",function(c){c.preventDefault(),debug&&console.log("Increasing the servings");var d=a(this),e=d.parent().parent();e.find(".opt").removeClass("selected"),d.addClass("selected"),b.updateCartForm({sku:e.attr("data-sku"),serving:d.html()})}),b.updateCartForm=function(c){var d=a(".item-f-"+c.sku);0!=d.length&&d.remove(),a("#cart-form").append('<input class="item-f-'+c.sku+'" name="items[]" value="'+c.sku+"|"+c.serving+'" />'),b.saveCartSession()},b.updateCart=function(d){var e=c(d),f=parseInt(a("#cart-item-count").val());if(0!=a("#item-"+d.sku).length){debug&&console.log("This item is already in the cart");var g="#item-"+d.sku,h=parseInt(a(g+" .selected").html());6>h&&(h+=2,a("#item-"+d.sku+" .opt").removeClass("selected"),a(g+" .opt-"+h).addClass("selected")),a(".item-f-"+d.sku).remove(),b.updateCartForm({sku:d.sku,serving:h})}else a("#cart-design").append(e),a("#cart-item-count").val(f+1),b.updateCartForm({sku:d.sku,serving:2})},b.saveCartSession=function(){var b=a("#cart-form-wrap").serialize();ajax("POST",b,base_url+"cart/sync",function(){})},b}(jQuery,API||{});